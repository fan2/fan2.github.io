<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[col.dog]]></title>
  <subtitle><![CDATA[just do IT]]></subtitle>
  <link href="/atom.xml" rel="self"/>
  <link href="http://col.dog/"/>
  <updated>2015-11-19T11:20:06.000Z</updated>
  <id>http://col.dog/</id>
  
  <author>
    <name><![CDATA[Thomas Fan]]></name>
    <email><![CDATA[phunxm@gmail.com]]></email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[git 版本控制]]></title>
    <link href="http://col.dog/2015/11/17/git-version-control/"/>
    <id>http://col.dog/2015/11/17/git-version-control/</id>
    <published>2015-11-16T23:13:23.000Z</published>
    <updated>2015-11-19T11:20:06.000Z</updated>
    <content type="html"><![CDATA[<p>之前梳理介绍过 <a href="http://blog.csdn.net/phunxm/article/details/40834427" target="_blank" rel="external">subversion 版本控制</a>，本文承接《<a href="http://blog.csdn.net/phunxm/article/details/45083335" target="_blank" rel="external">Mac下git通过SSH进行免密码安全连接github</a>》，结合具体操作实例贯串讲解 git 初级版本控制日常操作流程，备忘查阅。</p>
<a id="more"></a>
<h2 id="git_trends">git trends</h2><p><img src="http://img.blog.csdn.net/20150925231127034" alt="google trends of git"></p>
<p><img src="http://img.blog.csdn.net/20150925231200247" alt="google trends of github"></p>
<h2 id="git_for_Mac/Xcode">git for Mac/Xcode</h2><h3 id="whereis_git">whereis git</h3><p>在 Mac Terminal 中执行 <code>which</code> 或 <code>whereis</code> 命令可以查看 git 的位置：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  bin  which git&#10;/usr/bin/git&#10;&#10140;  bin  whereis git&#10;/usr/bin/git</span><br></pre></td></tr></table></figure>
<p><code>which git</code> 返回的结果是 <code>/usr/bin/git</code>，同svn一样，它们是Xcode安装 Command Line Tools 时安装的 git wrapper，或者叫 <a href="http://stackoverflow.com/questions/9329243/xcode-4-4-and-later-install-command-line-tools/" target="_blank" rel="external">shims or wrapper</a> executables，真正的工具包<strong>实体</strong>在 Xcode.app 里面：</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line">➜  ~  xcrun -f git</span><br><span class="line"><span class="regexp">/Applications/</span>Xcode.app<span class="regexp">/Contents/</span>Developer<span class="regexp">/usr/</span>bin<span class="regexp">/git</span></span><br></pre></td></tr></table></figure>
<h3 id="git_version">git version</h3><p>在终端输入 <code>git version</code> 或 <code>git --version</code> 可以查看到系统自带的 git 版本为2.3.8：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  ~  git version&#10;git version 2.3.8 (Apple Git-58)</span><br></pre></td></tr></table></figure>
<p>执行 <code>ls git*</code> 可查看 git binUtils 组成：</p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">➜  ~  <span class="keyword">cd</span> /usr/bin</span><br><span class="line">➜  bin  <span class="keyword">ls</span> git*</span><br><span class="line">git                git-receive-pack   git-upload-archive</span><br><span class="line">git-cvsserver      git-<span class="keyword">shell</span>          git-upload-pack</span><br></pre></td></tr></table></figure>
<h3 id="upgrade_git">upgrade git</h3><p>可从 git 官网下载 <a href="http://git-scm.com/download/mac" target="_blank" rel="external">git for Mac</a> 安装包（git-2.5.3-intel-universal-mavericks.dmg），点击 <code>git-2.5.3-intel-universal-mavericks.pkg</code> 可安装git binUtils，默认安装到 <code>/usr/local/git</code> 目录下:</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  ~  cd /usr/local/git/bin&#10;&#10140;  bin git:(master) ls&#10;git                        git-receive-pack           git-upload-pack&#10;git-credential-osxkeychain git-shell                  gitk&#10;git-cvsserver              git-upload-archive</span><br></pre></td></tr></table></figure>
<ol>
<li>可在bash下运行 <code>setup git PATH for non-terminal programs.sh</code> 脚本设置新版 git 为非命令行程序的默认 git。  </li>
<li>可参照Mac下升级<a href="http://blog.csdn.net/phunxm/article/details/40834427" target="_blank" rel="external">subversion工具包升级方法</a>，直接软链新版binUtils的 git* 到<code>/Applications/Xcode.app/Contents/Developer/usr/bin</code>下即可。</li>
</ol>
<h3 id="git_manual/help">git manual/help</h3><ol>
<li>输入 <code>git</code> 或 <code>git --help</code> 可以查看 git usage，一览 <em>most commonly used git commands</em> 要义：<br> <img src="http://img.blog.csdn.net/20150908072930624" alt="git --help">  </li>
<li>针对具体 commands，可以求助“男人”（man），以下示例查看 <strong><code>git add</code></strong> 帮助的两种方式：</li>
</ol>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  ~  git --help add&#65288;git help add&#65289;</span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  ~  man git add</span><br></pre></td></tr></table></figure>
<p>按 <code>q</code> 键退出 manual。</p>
<h2 id="git_config"><a href="http://blog.csdn.net/wirelessqa/article/details/8572928" target="_blank" rel="external">git config</a></h2><p>git 配置分为系统级别、用户级别和项目级别，<em><code>--global</code></em> 选项指定用户级别的配置。<br>以下配置用户 user 信息：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  ~  git config --global user.name fan2&#10;&#10140;  ~  git config --global user.email xxx@qq.com</span><br></pre></td></tr></table></figure>
<p>配置完成后，可以输入 <code>git config --list</code> 命令查看当前配置。<br>之后的 git 提交信息中将自动嵌入用户信息，即 <strong>git log</strong> 查看到的每条 log 的 Author 信息。<br>也可针对具体项目（cd 到 <code>.git</code> 所在目录）执行 <strong>git config</strong> 命令，而无需指定 <code>--system</code> 或 <code>--global</code> 选项，配置适用于<strong><em>独立项目</em></strong>的作者信息或代理信息（http.proxy）。</p>
<h2 id="git_init_repository">git init repository</h2><h3 id="cd_进入本地项目目录">cd 进入本地项目目录</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  ~  cd Projects/Xcode/resizableImageWithCapInsets</span><br></pre></td></tr></table></figure>
<p>查看当前目录：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  ~  pwd&#10;/Users/faner/Projects/Xcode/resizableImageWithCapInsets</span><br></pre></td></tr></table></figure>
<p>当前目录为空文件夹，<code>ls</code> 或 <code>ls -a</code> 列举显示无内容。</p>
<h3 id="查看当前项目（目录）的_git_状态">查看当前项目（目录）的 git 状态</h3><p>使用 <code>git status</code> 命令可以查看当前工作目录的 git 版本控制状态（增删改等）。</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140; resizableImageWithCapInsets  git status&#10;fatal: Not a git repository (or any of the parent directories): .git</span><br></pre></td></tr></table></figure>
<p><code>Not a git repository</code> 表明当前工程（项目）尚未纳入 git 版本控制。</p>
<h3 id="基于当前项目（目录）初始化_git_仓库">基于当前项目（目录）初始化 git 仓库</h3><p>创建初始化 git 版本库，需要使用 <code>git init</code> 命令：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets  git init --help&#10;&#10;NAME&#10;       git-init - Create an empty Git repository or reinitialize an existing one&#10;       &#10;DESCRIPTION&#10;       This command creates an empty Git repository - basically a .git directory with&#10;       subdirectories for objects, refs/heads, refs/tags, and template files. An&#10;       initial HEAD file that references the HEAD of the master branch is also&#10;       created.</span><br></pre></td></tr></table></figure>
<p>对当前项目（目录）执行 <code>git init</code> 命令，即可初始化一个本地git仓库：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets  git init  &#10;Initialized empty Git repository in /Users/faner/Projects/Xcode/resizableImageWithCapInsets/.git/</span><br></pre></td></tr></table></figure>
<p>此时运行 <code>ls -a</code> 列举当前目录：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets git:(master) ls -a  &#10;.    ..   .git</span><br></pre></td></tr></table></figure>
<p>可以发现该目录下新增了一个隐藏的 <code>.git</code> 文件夹，它保存了 git 版本控制信息。<br>若是从 github 等远程仓库克隆（git clone）项目到本地，则默认即是一个追踪了远程仓库的 git repository，无需再执行 <code>git init</code> 初始化。</p>
<p>此时，再次执行 <strong><code>git status</code></strong> 命令可查看初始化的本地仓库状态：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets git:(master) git status&#10;On branch master&#10;&#10;Initial commit&#10;&#10;nothing to commit (create/copy files and use &#34;git add&#34; to track)</span><br></pre></td></tr></table></figure>
<p>由于当前 Git Repo 刚初始化，没有任何增删改操作，故没啥好提交的：<code>nothing to commit</code>。<br>它提示创建（create）或从别处拷贝（copy）文件过来，并调用 <strong><code>git add</code></strong> 命令添加追踪。</p>
<p><strong>说明：</strong></p>
<blockquote>
<p>下文 git 操作都是基于<em>当前工作目录</em>，即包含 <code>.git</code> 的 <strong>Working directory</strong> / <strong>Working Tree</strong>。</p>
</blockquote>
<h2 id="git_add_to_Index">git add to Index</h2><h3 id="创建第一个文件——README-md">创建第一个文件——README.md</h3><p>1.执行 <code>touch README.md</code> 命令新建 README.md 文件：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets git:(master) touch README.md&#10;&#10140;  resizableImageWithCapInsets git:(master) &#10007; ls&#10;README.md</span><br></pre></td></tr></table></figure>
<p>2.执行 <code>vi README.md</code> 打开vi（m）进行编辑：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets git:(master) &#10007; vi README.md</span><br></pre></td></tr></table></figure>
<ul>
<li><kbd>i</kbd>: 进入 insert 模式编辑;</li>
<li><kbd>Esc</kbd>: 退出insert编辑模式;</li>
<li><code>:wq</code>: 保存退出(write &amp; quit)</li>
</ul>
<p>3.编辑完成执行 <code>cat README.md</code>，可查看文件内容：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets git:(master) &#10007; cat README.md  &#10;README for resizableImageWithCapInsets.</span><br></pre></td></tr></table></figure>
<p>4.再次执行 <strong><code>git status</code></strong> 命令可查看当前本地仓库状态：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets git:(master) &#10007; git status  &#10;On branch master  &#10;&#10;Initial commit  &#10;&#10;Untracked files:  &#10;  (use &#34;git add &#60;file&#62;...&#34; to include in what will be committed)  &#10;&#10;        README.md  &#10;&#10;nothing added to commit but untracked files present (use &#34;git add&#34; to track)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>Untracked files</code>，即新建的 README.md 文件未被 git 追踪（Unversioned/Untracked）。  </li>
<li><code>use &quot;git add&quot; to track</code>，提示使用 <code>git add</code> 命令将未追踪文件添加追踪（add to version control），纳入版本控制（tracked）。</li>
</ul>
<h3 id="将_README-md_文件添加到_git_index">将 README.md 文件添加到 git index</h3><p>添加本地文件到 git 版本控制，需要使用 <code>git add</code> 命令：  </p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  ~  git add --help&#10;&#10;NAME&#10;       git-add - Add file contents to the index&#10;&#10;DESCRIPTION&#10;       This command updates the index using the current content found in the working&#10;       tree, to prepare the content staged for the next commit. It typically adds the&#10;       current content of existing paths as a whole, but with some options it can also&#10;       be used to add content with only part of the changes made to the working tree&#10;       files applied, or remove paths that do not exist in the working tree anymore.&#10;&#10;       The &#34;index&#34; holds a snapshot of the content of the working tree, and it is this&#10;       snapshot that is taken as the contents of the next commit. Thus after making&#10;       any changes to the working directory, and before running the commit command,&#10;       you must use the add command to add any new or modified files to the index.</span><br></pre></td></tr></table></figure>
<blockquote>
<p>It typically adds the current content of existing paths as a whole, but with some options it can also be used to add content with <strong>only part</strong> of the changes made to the working tree files applied, or remove paths that do not exist in the working tree anymore.<br>The <strong>“index”</strong> holds a <strong>snapshot</strong> of the content of the working tree, and it is this snapshot that is taken as the contents of the next commit. <u>Thus after making <strong>any changes</strong> to the working directory, and before running the commit command, you must use the add command to add any <b><i>new</i></b> or <b><i>modified</i></b> files to the index.</u></p>
</blockquote>
<p><strong><code>index 的概念</code></strong>：</p>
<p>index 有时候也被称作 <code>Staging area</code> 或 <code>Cache</code>，<code>git add</code> 命令会将文件改动暂存到 index 中(<code>.git/index</code>)。</p>
<p><a href="http://stackoverflow.com/questions/3689838/difference-between-head-working-tree-index-in-git" target="_blank" rel="external"><img src="http://i.stack.imgur.com/naws3.png" alt="git add commit"></a></p>
<p><strong>git add 基本用法：</strong></p>
<blockquote>
<p>git add \<pathspec\></pathspec\></p>
</blockquote>
<ul>
<li><code>&lt;pathspec&gt;</code> 可以是 <code>.</code> ，表示添加当前目录下所有（<strong>as a whole</strong>）未追踪的文件或修改（unversioned/untracked files or modification）到 git 索引。  </li>
<li>也可以添加指定子目录层级的单个文件或多个文件列表（<strong>only part</strong>）。</li>
</ul>
<p><strong><code>添加 README.md 文件：</code></strong></p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets git:(master) &#10007; git add README.md</span><br></pre></td></tr></table></figure>
<p>由于当前文件只有一个 Untracked files，因此也可执行 <code>git add .</code>。<br>再次执行<strong><code>git status</code></strong>命令可查看当前本地仓库状态：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets git:(master) &#10007; git status&#10;On branch master&#10;&#10;Initial commit&#10;&#10;Changes to be committed:&#10;  (use &#34;git rm --cached &#60;file&#62;...&#34; to unstage)&#10;&#10;  new file:   README.md</span><br></pre></td></tr></table></figure>
<p>提示有改动需要提交（Changes to be committed）：新增了文件（new file:   README.md）。</p>
<p>此时，若反悔了，想解除对 README.md 文件的追踪（Undo an Added new file），亦可执行 <code>git rm --cached</code>：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets git:(master) &#10007; git rm --cached README.md&#10;rm &#39;README.md&#39;</span><br></pre></td></tr></table></figure>
<p>则 README.md 文件又恢复到 <code>git add</code> 之前的状态——Untracked。</p>
<p><strong><code>注意</code></strong>：  </p>
<ul>
<li>执行 <code>git rm --cached README.md</code> 只是将README.md文件从暂存区（Index/Staging area）移除，文件依旧保留（keep the file）；  </li>
<li>若执行 <code>rm</code> 或 <code>git rm -f README.md</code>，则强制物理删除（force removal）本地文件。</li>
</ul>
<h2 id="git_commit_to_local_repository">git commit to local repository</h2><p>将暂存区中的变更提交到到git仓库，需要使用 <code>git commit</code> 命令：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  ~  git commit --help&#10;&#10;NAME&#10;       git-commit - Record changes to the repository&#10;&#10;DESCRIPTION&#10;       Stores the current contents of the index in a new commit along with a log&#10;       message from the user describing the changes.&#10;&#10;OPTIONS&#10;&#10;       -m &#60;msg&#62;, --message=&#60;msg&#62;&#10;           Use the given &#60;msg&#62; as the commit message. If multiple -m options are&#10;           given, their values are concatenated as separate paragraphs.</span><br></pre></td></tr></table></figure>
<p>之前在 resizableImageWithCapInsets 这个 WC（Working directory/Working tree）新增（git add）了 README.md 文件。这个 <code>git add</code> 新增变更是记录在index（staging area）中，下面将其添加到本地 git 仓库。</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets git:(master) &#10007; git commit -m &#34;This is the first commit.&#34;  &#10;[master (root-commit) ee53e68] This is the first commit.  &#10;  1 file changed, 1 insertion(+)  &#10;  create mode 100644 README.md</span><br></pre></td></tr></table></figure>
<p>其中 <code>-m</code> 选项续接的双引号（” “）内容指定提交日志信息，也可以使用 <kbd>$</kbd> 续接单引号（’ ‘）支持 <code>\n</code> 换行，从而输入多行 log message lines。</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  test git:(master) &#10007; git commit -m $&#39;log line 1\nlog line 2&#39;&#10;&#10;&#10140;  test git:(master) git log &#10;&#10;commit 0b9420ce187b8e8b5307b49f3b6af038847e4857&#10;Author: fan2 &#60;xxx@qq.com&#62;&#10;Date:   Tue Nov 17 07:41:42 2015 +0800&#10;&#10;    log line 1&#10;    log line 2&#10;(END)</span><br></pre></td></tr></table></figure>
<hr>
<p>commit 提交后，再次执行 <strong><code>git status</code></strong> 命令查看当前本地仓库状态：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets git:(master) git status&#10;On branch master&#10;nothing to commit, working directory clean</span><br></pre></td></tr></table></figure>
<p><code>&quot;nothing to commit, working directory clean&quot;</code> 表示变更已入库，当前工作目录是干净（clean）的。</p>
<p>执行 <code>git commit</code> 提交后，可通过 <strong><code>git log</code></strong> 命令查看提交日志：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">commit ee53e68e599695f15b8e91d5eb3fd490f945a23e  &#10;Author: fan2 &#60;xxx@qq.com&#62;  &#10;Date:   Sun Sep 13 15:34:13 2015 +0800  &#10;&#10;    This is the first commit.</span><br></pre></td></tr></table></figure>
<p>按 <code>q</code> 键退出log。</p>
<p>后续多次提交后，可通过 <a href="http://www.cnblogs.com/gbyukg/archive/2011/12/12/2285419.html" target="_blank" rel="external"><code>git log</code></a> 的 <code>-n</code> 选项（svn 中为 -l ）指定 Limit the number of commits to output，例如 <code>git log -n 2</code> 查看最近两次的提交log。</p>
<h3 id="git本地仓库">git本地仓库</h3><p>git 本地仓库由 git 维护的三棵“树”组成：</p>
<ul>
<li>第一个是 物理工作目录（Working tree），它持有实际文件；</li>
<li>第二个是 暂存区（Index），它像个缓存区域，临时保存你的改动；</li>
<li>最后是 repository，HEAD 指向你最后一次提交（commit）的结果。</li>
</ul>
<p><a href="rogerdudler.github.io/git-guide/index.zh.html"><img src="http://rogerdudler.github.io/git-guide/img/trees.png" alt="git本地仓库"></a></p>
<h2 id="git_add_modificaion_/_rm_tracked_file">git add modificaion / rm tracked file</h2><h3 id="修改文件">修改文件</h3><p>将 README.md 文件 add 添加到 git 版本控制并 commit 提交到 git 仓库后，稍微改动一下 README.md 文件：增加第二行空行，第三行增加”this is the content. “。然后，使用 <code>git diff</code> 或 <code>git diff --</code> 命令查看工作目录与索引区文件之间的差异：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets git:(master) &#10007; git diff README.md  &#10;diff --git a/README.md b/README.md  &#10;index 717aedf..0a1832d 100644  &#10;--- a/README.md  &#10;+++ b/README.md  &#10;@@ -1 +1,3 @@  &#10;&#38;nbsp;README for resizableImageWithCapInsets.  &#10;+  &#10;+this is the content.</span><br></pre></td></tr></table></figure>
<p>按 <code>q</code> 键退出 diff。</p>
<p>以上也可使用 <code>git diff HEAD</code> 命令查看工作目录与 git 仓库之间的差异。</p>
<p>再次执行 <strong><code>git status</code></strong> 命令查看当前本地仓库状态：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets git:(master) git status&#10;On branch master&#10;Changes not staged for commit:&#10;  (use &#34;git add &#60;file&#62;...&#34; to update what will be committed)&#10;  (use &#34;git checkout -- &#60;file&#62;...&#34; to discard changes in working irectory)&#10;&#10;    modified:   README.md&#10;&#10;no changes added to commit (use &#34;git add&#34; and/or &#34;git commit -a&#34;)</span><br></pre></td></tr></table></figure>
<p>提示修改了 README.md 文件（状态为 modified），但是修改没有添加到缓存（Changes not staged）。此种状态下，可以执行两种操作： </p>
<ul>
<li><code>git checkout -- &lt;file&gt;</code> ：<strong>放弃</strong>本地修改，恢复到上次 commit 完的”干净”版本<strong>Index</strong>中的文件记录。</li>
<li><code>git add &lt;file&gt;</code> ：提交更新到缓存。</li>
</ul>
<hr>
<p>执行 <strong><code>git add</code></strong> 命令可以将更改提交到暂存区（index/staging area）： </p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets git:(master) &#10007; git add README.md  &#10;&#10140;  resizableImageWithCapInsets git:(master) &#10007; git status  &#10;On branch master  &#10;Changes to be committed:  &#10;  (use &#34;git reset HEAD &#60;file&#62;...&#34; to unstage)  &#10;&#10;  modified:   README.md</span><br></pre></td></tr></table></figure>
<p>正常情况下，对于通过 <b><code>git add</code></b> 添加到暂存区的变更，需进一步执行 <b><code>git commit</code></b> 提交到本地git仓库。这两步操作也可糅合为 <strong><code>git commit -a</code></strong> 命令一步到位。<code>-a</code> 选项意即 <code>all</code> ，提交所有变更。</p>
<p>在 <code>git commit</code> 提交之前，可执行 <code>git diff --cached</code> 命令查看索引区与 git 仓库之间的差异。</p>
<h4 id="git_diff">git diff</h4><p>现在来总结一下使用频率较高的 <code>git diff</code> 命令：</p>
<table>
<thead>
<tr>
<th>cmd</th>
<th>ways to check diff</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>git diff</code></td>
<td>Changes in the working tree not yet staged for the next commit</td>
</tr>
<tr>
<td><code>git diff --cached</code></td>
<td>Changes between the index and your last commit; what you would be committing if you run “git commit” without “-a” option. <br><code>--staged</code> is a synonym of <code>--cached</code>.</td>
</tr>
<tr>
<td><code>git diff HEAD</code></td>
<td>Changes in the working tree since your last commit; what you would be committing if you run “git commit -a”<br><code>git diff HEAD^</code>：比较上次提交；<br><code>git diff HEAD^ HEAD</code>：Compare the version before the last commit and the last commit. <br><code>git diff HEAD~2</code>：比较上2次提交。</td>
</tr>
</tbody>
</table>
<p>关于 <a href="http://www.gitguys.com/topics/git-diff/?lang=zh" target="_blank" rel="external">git diff</a> 命令，可参考 <a href="http://www.cnblogs.com/gbyukg/archive/2011/12/13/2286884.html" target="_blank" rel="external">git diff</a> 和 <a href="http://www.ruanyifeng.com/blog/2012/08/how_to_read_diff.html" target="_blank" rel="external">读懂 diff</a>。</p>
<p>使用 <code>git diff</code> 命令时，也可指定 difftool：</p>
<figure class="highlight ocaml"><table><tr><td class="code"><pre><span class="line">➜  test git:(master) ✗ git difftool </span><br><span class="line"></span><br><span class="line"><span class="type">This</span> message is displayed because <span class="symbol">'diff</span>.tool' is not configured.</span><br><span class="line"><span class="type">See</span> <span class="symbol">'git</span> difftool --tool-help' <span class="keyword">or</span> <span class="symbol">'git</span> help config' <span class="keyword">for</span> more details.</span><br><span class="line"><span class="symbol">'git</span> difftool' will now attempt <span class="keyword">to</span> use one <span class="keyword">of</span> the following tools:</span><br><span class="line">opendiff kdiff3 tkdiff xxdiff meld kompare gvimdiff diffuse diffmerge ecmerge p4merge araxis bc codecompare emerge vimdiff</span><br><span class="line"></span><br><span class="line"><span class="type">Viewing</span> (<span class="number">1</span>/<span class="number">1</span>): <span class="symbol">'README</span>.md'</span><br><span class="line"><span class="type">Launch</span> <span class="symbol">'opendiff'</span> [<span class="type">Y</span>/n]:</span><br></pre></td></tr></table></figure>
<p>配置 <code>vimdiff</code> 作为 git difftool：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">git config --global diff.tool vimdiff`</span><br></pre></td></tr></table></figure>
<p><a href="http://www.cnblogs.com/kangyi/p/4827078.html" target="_blank" rel="external">AraxisMerge和 Beyond Compare 做 git mergetool 配置</a><br><a href="http://blog.csdn.net/snowdream86/article/details/8807397" target="_blank" rel="external">Git 集成 Araxis Merge 作为比较和合并 GUI 工具的配置</a><br><a href="https://lautaportti.wordpress.com/2009/02/11/using-araxis-merge-with-git/" target="_blank" rel="external">Using Araxis Merge with Git</a><br><a href="http://stackoverflow.com/questions/14593817/how-do-i-configure-araxis-merge-for-use-with-git" target="_blank" rel="external">how-do-i-configure-araxis-merge-for-use-with-git</a></p>
<h4 id="git_reset_HEAD">git reset HEAD</h4><p>若想放弃通过 <code>git add</code> 提交到暂存区中的修改（Unstaging a Staged File/Undo an Added new modification），可执行 <code>git reset HEAD &lt;file&gt;</code> 撤销提交到暂存中的修改：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets git:(master) &#10007; git reset HEAD README.md  &#10;Unstaged changes after reset:  &#10;M&#9;README.md</span><br></pre></td></tr></table></figure>
<p>执行 <code>git reset HEAD</code> 后，Index/Staging Area 中记录的 README.md 文件恢复恢复到上次commit 完 local repository 中的 HEAD 文件记录。Working tree中 README.md 文件的状态则恢复为 modified（Changes Unstaged relative to index），可执行 <code>git status</code> 查看最新状态。可以继续编辑 README.md 再适时提交。</p>
<h3 id="删除文件">删除文件</h3><p>将 README.md 文件添加到 git 版本控制并且提交到 git 仓库后，，可以使用 <code>git rm</code> 命令删除本地 git 仓库中的 tracked/versioned 文件：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets git:(master) git rm README.md&#10;rm &#39;README.md&#39;</span><br></pre></td></tr></table></figure>
<p>再次执行 <strong><code>git status</code></strong> 命令查看当前本地仓库状态：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets git:(master) &#10007; git status  &#10;On branch master  &#10;Changes to be committed:  &#10;  (use &#34;git reset HEAD &#60;file&#62;...&#34; to unstage)  &#10;&#10;    deleted:    README.md</span><br></pre></td></tr></table></figure>
<p>可执行 <code>git reset HEAD &lt;file&gt;</code> 撤销提交到暂存中的 <code>git rm</code> 操作（recover by local repository’s HEAD to resume unstage status），也可以进一步执行 <b><code>git commit</code></b> 提交缓存操作到本地 git 仓库生效。</p>
<hr>
<p>在正式推送到远程仓库之前，若想撤销最近一次的 commit 怎么办呢？可参考《<a href="http://www.miss77.net/804.html" target="_blank" rel="external">git 撤销commit</a>》、《<a href="http://www.cnblogs.com/mengdd/p/3586106.html" target="_blank" rel="external">Git 撤销修改1</a>》、《<a href="http://blog.csdn.net/baple/article/details/39640129" target="_blank" rel="external">Git 撤销修改2</a>》。</p>
<p>我们上面在示范 <code>commit -m</code> 多行 log 时，commit 的 Hash ID 是 <code>0b9420ce187b8e8b5307b49f3b6af038847e4857</code>：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  test git:(master) &#10007; git commit -m $&#39;log line 1\nlog line 2&#39;&#10;&#10;&#10140;  test git:(master) git log &#10;&#10;commit 0b9420ce187b8e8b5307b49f3b6af038847e4857</span><br></pre></td></tr></table></figure>
<p>假如，我们后来针对 <code>test</code> 这个版本库作了多次 commit 提交，怎么才能回退到多行log这个初始版本呢？<br>执行 <code>git reset --hard &lt;commit&gt;</code> 命令，可以回退到指定 commit。</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">git reset [&#60;mode&#62;] [&#60;commit&#62;]&#10;           This form resets the current branch head to &#60;commit&#62; and possibly updates the index (resetting it to the tree of &#60;commit&#62;) and the working tree depending on &#60;mode&#62;. If &#60;mode&#62; is omitted, defaults to &#34;--mixed&#34;. The &#60;mode&#62; must be one of the following:&#10;&#10;&#10;&#10; --hard&#10;               Resets the index and working tree. Any changes to tracked files in the working tree since &#60;commit&#62; are discarded.</span><br></pre></td></tr></table></figure>
<p>执行  <code>git reset --hard 0b9420ce187b8e8b5307b49f3b6af038847e4857</code> ，可以回退到 0b9420ce187b8e8b5307b49f3b6af038847e4857 这个版本。</p>
<h3 id="重命名文件（夹）">重命名文件（夹）</h3><p><strong><a href="http://www.patrick-wied.at/blog/rename-files-and-folders-with-git" target="_blank" rel="external">Rename files and folders with git</a></strong></p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">mv oldfolder newfolder  &#10;git add newfolder  &#10;git remove oldfolder</span><br></pre></td></tr></table></figure>
<p>本质上就是备份重命名，然后 remove 旧的，add 新的，实现替换重命名。<br>执行完以上命令后，可以进一步执行 <code>git commit</code> 提交缓存的 <code>rename</code> 操作到本地git仓库生效。</p>
<h2 id="git_push_(_merge_local_to_remote_)">git push ( merge local to remote )</h2><p>前面我们本地 git 初始化了 resizableImageWithCapInsets 项目，并新增提交了  README.md 文件，所有改动已经提交到了本地仓库的 HEAD，但是还没到提交到 git 远程仓库。执行 <code>git status</code> 命令可查看当前状态：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets git:(master) git status  &#10;On branch master  &#10;Your branch is ahead of &#39;origin/master&#39; by 1 commit.  &#10;   (use &#34;git push&#34; to publish your local commits)  &#10;nothing to commit, working directory clean</span><br></pre></td></tr></table></figure>
<ul>
<li><code>Your branch is ahead of &#39;origin/master&#39; by 1 commit</code>：提示我们的git本地仓库已经超过远程仓库一个版本。  </li>
<li><code>use &quot;git push&quot; to publish your local commits</code>：建议我们使用 <strong><code>git push</code></strong> 命令发布本地仓库上提交的修改。</li>
</ul>
<p>git 是分布式版本控制系统。对于一个分布式节点来说，其它节点的 git 仓库都可以作为本地仓库的<strong>远程仓库</strong>，可理解为“git 服务器”。当项目进行到一定的阶段时，要同别人分享目前的成果，可以使用 <code>git push</code> 命令将本地仓库中的数据推送到远程仓库。</p>
<p>在当前 Working tree 执行 <code>git remote -v</code> 查看其对应的远程仓库。<br>resizableImageWithCapInsets<br><figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets git:(master) &#10007; git remote -v</span><br></pre></td></tr></table></figure></p>
<p>可以看到列出来的结果为空，实际上我们本地演示的 git 仓库尚未挂接到任何远端仓库。</p>
<p>这里移步 <a href="https://github.com/" target="_blank" rel="external">github</a>，关于本地通过 SSH 与 github 连接请参考《<a href="http://blog.csdn.net/phunxm/article/details/45083335" target="_blank" rel="external">Mac下git通过SSH进行免密码安全连接github</a>》。<br>由于<code>Github does not provide shell access</code>，因此需要去 github 个人主页手动创建仓库。Add a New Repository，命名为 resizableImageWithCapInsets，对应的URL为：</p>
<table>
<thead>
<tr>
<th>type</th>
<th>URL</th>
</tr>
</thead>
<tbody>
<tr>
<td>SSH clone URL</td>
<td>git@github.com:fan2/resizableImageWithCapInsets.git</td>
</tr>
<tr>
<td>HTTPS clone URL</td>
<td><a href="https://github.com/fan2/resizableImageWithCapInsets.git" target="_blank" rel="external">https://github.com/fan2/resizableImageWithCapInsets.git</a></td>
</tr>
<tr>
<td>Subversion checkout URL</td>
<td><a href="https://github.com/fan2/resizableImageWithCapInsets" target="_blank" rel="external">https://github.com/fan2/resizableImageWithCapInsets</a></td>
</tr>
</tbody>
</table>
<p>由上可知 github 也提供了 subversion 支持，实际上 git 也可以与通过 <a href="http://blog.chinaunix.net/uid-11639156-id-3077471.html" target="_blank" rel="external">git-svn</a> 子命令与已有的SVN中心库进行同步。</p>
<h3 id="连接远程仓库">连接远程仓库</h3><p>git 对远程仓库的操作主要是基于 <code>git remote</code> 命令：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  ~  git remote --help&#10;&#10;NAME&#10;       git-remote - Manage set of tracked repositories&#10;&#10;DESCRIPTION&#10;       Manage the set of repositories (&#34;remotes&#34;) whose branches you track.&#10;&#10;COMMANDS&#10;&#10;       add&#10;           Adds a remote named &#60;name&#62; for the repository at &#60;url&#62;.&#10;&#10;       remove, rm&#10;           Remove the remote named &#60;name&#62;. All remote-tracking branches and&#10;           configuration settings for the remote are removed.&#10;&#10;       set-url&#10;           Changes URLs for the remote.</span><br></pre></td></tr></table></figure>
<p>Adds a remote named <name> for the repository at <url>. </url></name></p>
<p>下面执行 <code>git remote add</code> 命令将当前本地 git 仓库挂接到指定的远程仓库（即追踪远程仓库）：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets git:(master) &#10007; git remote add origin git@github.com:fan2/resizableImageWithCapInsets.git</span><br></pre></td></tr></table></figure>
<p>这里将 github 远端仓库地址保存到 <code>origin</code> 变量中，后面 push、fetch、merge 等操作可直接引用 origin 变量指代远端地址。<br>此时再执行执行 <code>git remote -v</code>（–verbose：Be a little more verbose and show remote url after name），可查看 origin 具体代表的 fetch/push 远端地址：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets git:(master) &#10007; git remote -v  &#10;origin&#9;git@github.com:fan2/resizableImageWithCapInsets.git (fetch)  &#10;origin&#9;git@github.com:fan2/resizableImageWithCapInsets.git (push)</span><br></pre></td></tr></table></figure>
<p>如果执行 <code>git remote add</code> 命令时提示 <code>fatal: remote origin already exists.</code>，或者想更改挂接的远端地址（比如远程仓库重命名了或移动了），可以按照以下步骤操作：</p>
<blockquote>
<p>先执行命令：git remote rm origin<br>再执行命令：git remote add origin <remotegitrepourl></remotegitrepourl></p>
</blockquote>
<p><strong><code>git remote set-url</code></strong>（Changes URLs for the remote）相当于 rm+add：</p>
<blockquote>
<p><a href="https://help.github.com/articles/changing-a-remote-s-url/" target="_blank" rel="external">Changing a remote’s URL</a><br><a href="http://stackoverflow.com/questions/1800859/how-can-i-change-the-remote-target-repository-url-on-windows" target="_blank" rel="external">How can I change the remote/target repository URL</a><br><a href="http://stackoverflow.com/questions/2432764/change-the-uri-url-for-a-remote-git-repository" target="_blank" rel="external">Change the URI (URL) for a remote Git repository</a></p>
</blockquote>
<p>出于安全考虑，一般公司可能会屏蔽掉 SSH 协议，此时可以 <code>rm &amp; add</code> (或 set-url) 切换为 HTTPS clone URL，但是每次 git push 时都会提示输入用户名和密码。在 OS X 上可以使用 keychain 来缓存密码：</p>
<blockquote>
<p>git config –global credential.helper osxkeychain</p>
</blockquote>
<h3 id="git推送更新到远程仓库">git推送更新到远程仓库</h3><p>我们前面使用 <code>git commit</code> 命令将本地工作目录的变更提交（合并）到本地仓库，解析来可以使用 <code>git push</code> 命令来将本地仓库的变更提交（合并）到它所追踪的远程仓库：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">➜  ~  git push <span class="comment">--help</span></span><br><span class="line"></span><br><span class="line">NAME</span><br><span class="line">       git-push - <span class="operator"><span class="keyword">Update</span> remote refs along <span class="keyword">with</span> associated objects</span><br><span class="line"></span><br><span class="line">DESCRIPTION</span><br><span class="line">       Updates remote refs <span class="keyword">using</span> <span class="keyword">local</span> refs, <span class="keyword">while</span> sending objects necessary <span class="keyword">to</span> <span class="keyword">complete</span> the given refs.</span><br><span class="line"></span><br><span class="line">OPTIONS</span><br><span class="line">       -u, <span class="comment">--set-upstream</span></span><br><span class="line">           <span class="keyword">For</span> every branch that <span class="keyword">is</span> up <span class="keyword">to</span> <span class="built_in">date</span> <span class="keyword">or</span> successfully pushed, <span class="keyword">add</span> upstream (<span class="keyword">tracking</span>) <span class="keyword">reference</span>, used <span class="keyword">by</span> argument-<span class="keyword">less</span> git-pull(<span class="number">1</span>) <span class="keyword">and</span> other commands.</span><br><span class="line">           <span class="keyword">For</span> more information, see branch.&lt;<span class="keyword">name</span>&gt;.<span class="keyword">merge</span> <span class="keyword">in</span> git-config(<span class="number">1</span>).</span></span><br></pre></td></tr></table></figure>
<p>执行以下命令可以将本地仓库变更提交（合并）到它所追踪的远程仓库 origin 的 master 分支：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets git:(master) &#10007; git push -u origin master</span><br></pre></td></tr></table></figure>
<h2 id="git_rebase_from_remote_(_pull_=_fetch_+_merge)">git rebase from remote ( pull = fetch + merge)</h2><p>当本地仓库跟踪的远程仓库发生变更时，需要rebase（merge from remote to local）。</p>
<h3 id="fetch_+_merge">fetch + merge</h3><ul>
<li><code>git fetch</code> 取得两个版本的差异：</li>
</ul>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  ~  git fetch --help&#10;&#10;NAME&#10;       git-fetch - Download objects and refs from another repository&#10;&#10;DESCRIPTION&#10;       Fetch branches and/or tags (collectively, &#34;refs&#34;) from one or more other&#10;       repositories.</span><br></pre></td></tr></table></figure>
<p>调用 <code>git fetch origin</code> 取得 remote 仓库 origin（master分支）相对local repository HEAD 的变动 diff delta。</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets git:(master) &#10007; git fetch origin</span><br></pre></td></tr></table></figure>
<ul>
<li><code>git merge</code>命令合并两个版本：</li>
</ul>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  ~  git merge --help&#10;&#10;NAME&#10;       git-merge - Join two or more development histories together&#10;&#10;DESCRIPTION&#10;       Incorporates changes from the named commits (since the time their histories&#10;       diverged from the current branch) into the current branch. This command is used&#10;       by git pull to incorporate changes from another repository and can be used by&#10;       hand to merge changes from one branch into another.</span><br></pre></td></tr></table></figure>
<p>调用 <code>git merge origin/master</code> 把更新（远程origin/master相对local repository的 diff ）合并（patch）到本地分支 HEAD 。</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  resizableImageWithCapInsets git:(master) &#10007; git merge origin/master</span><br></pre></td></tr></table></figure>
<p>如有多个分支，可调用 <code>git branch</code> 命令查看当前分支。</p>
<h3 id="pull">pull</h3><p>当我们在本地修改了文件准备 push 推送提交时，有人已经 push 改动过远程仓库，此时 git 会提示 failed，需要执行 <strong>pull before push</strong>：</p>
<p><img src="http://img.blog.csdn.net/20150925230344452" alt="git pull &amp; push"></p>
<blockquote>
<p>git pull = fetch + merge</p>
</blockquote>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">➜  ~  git pull <span class="comment">--help</span></span><br><span class="line"></span><br><span class="line">NAME</span><br><span class="line">       git-pull - Fetch <span class="built_in">from</span> <span class="operator">and</span> integrate <span class="operator">with</span> another repository <span class="operator">or</span> <span class="operator">a</span> <span class="built_in">local</span> branch</span><br><span class="line"></span><br><span class="line">DESCRIPTION</span><br><span class="line">       Incorporates changes <span class="built_in">from</span> <span class="operator">a</span> remote repository <span class="keyword">into</span> <span class="operator">the</span> current branch. In its</span><br><span class="line">       default mode, git pull is shorthand <span class="keyword">for</span> git fetch followed <span class="keyword">by</span> git <span class="built_in">merge</span></span><br><span class="line">       FETCH_HEAD.</span><br><span class="line"></span><br><span class="line">       More precisely, git pull runs git fetch <span class="operator">with</span> <span class="operator">the</span> given parameters <span class="operator">and</span> calls git</span><br><span class="line">       <span class="built_in">merge</span> <span class="built_in">to</span> <span class="built_in">merge</span> <span class="operator">the</span> retrieved branch heads <span class="keyword">into</span> <span class="operator">the</span> current branch. With</span><br><span class="line">       <span class="comment">--rebase, it runs git rebase instead of git merge.</span></span><br></pre></td></tr></table></figure>
<p>一般在执行 <code>git pull</code> 之后，重新执行 <code>git push</code> 可成功提交。</p>
<p>有时候，别人和自己改动了同一个文件，当自己 pull 时会提示 conflict：</p>
<p><img src="http://img.blog.csdn.net/20150925230223046" alt="git conflict"></p>
<p><code>Automatic merge failed</code>，此时需要我们手动解决冲突再重新 push 提交（fix conflicts and then commit the result）。</p>
<h2 id="参考：">参考：</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;《<a href="http://blog.jobbole.com/50603/" target="_blank" rel="external">写给Git初学者的7个建议</a>》<br>&nbsp;&nbsp;&nbsp;&nbsp;《<a href="http://blog.csdn.net/xiahouzuoxin/article/details/9393119" target="_blank" rel="external">我也用github</a>》《<a href="http://www.cnblogs.com/fnng/archive/2012/01/07/2315685.html" target="_blank" rel="external">git/github初级运用自如</a>》</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;《<a href="http://rogerdudler.github.io/git-guide/index.zh.html" target="_blank" rel="external">git - 简明指南</a>》《<a href="http://www.ibm.com/developerworks/cn/opensource/os-cn-tourofgit/" target="_blank" rel="external">IBM developerWorks-Git之旅</a>》<br>&nbsp;&nbsp;&nbsp;&nbsp;《<a href="http://roclinux.cn/?cat=72&amp;paged=5" target="_blank" rel="external">看日记学git</a>》《<a href="http://blog.csdn.net/wirelessqa/article/category/1522507" target="_blank" rel="external">码农老毕-开发工具之git</a>》《<a href="http://blog.sevenche.com/2014/02/Git-cook-book/" target="_blank" rel="external">Git Cookbook</a>》<br>&nbsp;&nbsp;&nbsp;&nbsp;《<a href="http://blog.atime.me/note/git-quick_reference.html" target="_blank" rel="external">Git快速使用指南</a>》《<a href="http://blog.atime.me/note/git-advanced_tutorial.html" target="_blank" rel="external">Git进阶教程</a>》<br>&nbsp;&nbsp;&nbsp;&nbsp;《<a href="http://www.ruanyifeng.com/blog/2014/06/git_remote.html" target="_blank" rel="external">Git远程操作详解</a>》《<a href="http://www.ruanyifeng.com/blog/2012/07/git.html" target="_blank" rel="external">Git分支管理策略</a>》</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;《<a href="http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000" target="_blank" rel="external">廖雪峰-Git教程</a>》《<a href="https://ihower.tw/git/index.html" target="_blank" rel="external">Git版本控制系統</a>》<br>&nbsp;&nbsp;&nbsp;&nbsp;《OPEN经验库 - <a href="http://www.open-open.com/lib/view/1328069609436" target="_blank" rel="external">Git起步</a> &amp; <a href="http://www.open-open.com/lib/view/open1328069733264.html" target="_blank" rel="external">Git基础</a>》<br>&nbsp;&nbsp;&nbsp;&nbsp;《<a href="http://wenku.baidu.com/view/51d372c22cc58bd63186bdc7.html" target="_blank" rel="external">Git权威指南</a>》《<a href="http://www.worldhello.net/gotgithub/index.html" target="_blank" rel="external">GotGitHub</a>》<br>&nbsp;&nbsp;&nbsp;&nbsp;《<a href="http://gitref.org/" target="_blank" rel="external">Git Reference</a>》《<a href="http://gitref.justjavac.com/index.html" target="_blank" rel="external">Git参考手册</a>》<br>&nbsp;&nbsp;&nbsp;&nbsp;《<a href="http://gitbook.liuhui998.com/" target="_blank" rel="external">Git Community Book 中文版</a>》《<a href="http://liuhui998.com/2011/01/21/git-adventures-1/" target="_blank" rel="external">Git历险记</a>》<br>&nbsp;&nbsp;&nbsp;&nbsp;《Git Book/Pro Git: <a href="http://git-scm.com/book/en/v2" target="_blank" rel="external">en</a> &amp; <a href="http://git-scm.com/book/zh/v2/" target="_blank" rel="external">cn</a>》《<a href="https://github.com/progit/progit2" target="_blank" rel="external">progit2 on GitHub</a>》<br>&nbsp;&nbsp;&nbsp;&nbsp;《<a href="http://www.gitguys.com/table-of-contents/?lang=zh" target="_blank" rel="external">Git Guys</a>》《<a href="https://www.atlassian.com/git/" target="_blank" rel="external">Atlassian Git Tutorial</a>》</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;《<a href="http://www.youku.com/playlist_show/id_22222576.html" target="_blank" rel="external">git中文入门教学视频1</a>》 《<a href="http://www.jikexueyuan.com/course/git/" target="_blank" rel="external">git中文入门教学视频2</a>》</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;《<a href="http://danielkummer.github.io/git-flow-cheatsheet/index.zh_CN.html" target="_blank" rel="external">git-flow 备忘清单</a>》《<a href="http://www.jianshu.com/p/Ev3s2o" target="_blank" rel="external">Git工作流</a>》《<a href="http://www.ruanyifeng.com/blog/2015/08/git-use-process.html" target="_blank" rel="external">Git 使用规范流程</a>》<br>&nbsp;&nbsp;&nbsp;&nbsp;《<a href="https://ruby-china.org/topics/17590" target="_blank" rel="external">Git思维导图</a>》《<a href="http://www.cnblogs.com/1-2-3/archive/2010/07/18/git-commands.html" target="_blank" rel="external">msysGit思维导图</a>》<br>&nbsp;&nbsp;&nbsp;&nbsp;《<a href="http://blog.csdn.net/lxd875697126/article/details/22976183" target="_blank" rel="external">托管项目到GitHub</a>》《<a href="http://blog.csdn.net/yangbo_hbzjk/article/details/9022767" target="_blank" rel="external">上传本地项目到github</a>》<br>&nbsp;&nbsp;&nbsp;&nbsp;《<a href="http://www.yangzhiping.com/tech/github.html" target="_blank" rel="external">如何高效利用GitHub</a>》《<a href="http://www.cnblogs.com/cocowool/archive/2012/02/17/2356125.html" target="_blank" rel="external">Git的深入理解与GitHub托管服务的使用</a>》</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>之前梳理介绍过 <a href="http://blog.csdn.net/phunxm/article/details/40834427">subversion 版本控制</a>，本文承接《<a href="http://blog.csdn.net/phunxm/article/details/45083335">Mac下git通过SSH进行免密码安全连接github</a>》，结合具体操作实例贯串讲解 git 初级版本控制日常操作流程，备忘查阅。</p>]]>
    
    </summary>
    
      <category term="git-add" scheme="http://col.dog/tags/git-add/"/>
    
      <category term="git-commit" scheme="http://col.dog/tags/git-commit/"/>
    
      <category term="git-init" scheme="http://col.dog/tags/git-init/"/>
    
      <category term="git-pull" scheme="http://col.dog/tags/git-pull/"/>
    
      <category term="git-push" scheme="http://col.dog/tags/git-push/"/>
    
      <category term="git" scheme="http://col.dog/categories/git/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[基于 Hexo 和 GitHub Pages 搭建博客]]></title>
    <link href="http://col.dog/2015/11/12/hello-world/"/>
    <id>http://col.dog/2015/11/12/hello-world/</id>
    <published>2015-11-12T11:27:00.000Z</published>
    <updated>2015-11-19T16:34:04.000Z</updated>
    <content type="html"><![CDATA[<p>本文详细记录了从安装 node.js / Hexo 到 使用 hexo 发布 markdown 格式的博客并托管到 GitHub 的全过程。</p>
<a id="more"></a>
<h2 id="配置环境">配置环境</h2><p>本文的操作流程和步骤基于 MacBook Pro + OS X EI Capitan 平台。</p>
<h2 id="安装_Node-js_+_NPM">安装 Node.js + NPM</h2><h3 id="什么是_Node-js_?">什么是 Node.js ?</h3><p><a href="http://nodejs.cn/" target="_blank" rel="external">Node.js</a> 是一个基于 <a href="https://developers.google.com/v8/" target="_blank" rel="external">Chrome V8</a> 引擎的 JavaScript 运行环境。Node.js 使用了一个事件驱动、非阻塞式 I/O 的模型，使其轻量又高效。Node.js 的包管理器 <a href="https://www.npmjs.com/" target="_blank" rel="external">npm</a>，是全球最大的跨平台开源库生态系统。<br>正如 <a href="http://en.wikipedia.org/wiki/Nodejs" target="_blank" rel="external">维基百科</a> 所说：“Node.js 是谷歌 V8 引擎、libuv 平台抽象层以及主体使用 Javscript 编写的核心库三者集合的一个包装外壳。”   </p>
<blockquote>
<p>注：V8是谷歌开发的，目前公认最快的 Javascript 解析引擎；libuv 是一个开源的、为 Node 定制而生的跨平台异步 IO 库。</p>
</blockquote>
<p>Node.js 服务器端和网络应用程序是使用 JavaScript 脚本语言编写，并可以在 Mac OS X、Microsoft Windows 和 Linux 内的 Node.js 运行时运行。<br>Node.js还提供了丰富的各种模块的 <a href="http://nodeapi.ucdok.com/" target="_blank" rel="external">JavaScript</a> 库，从而简化了 Node.js 的使用，方便 Web 应用程序的研究与开发。</p>
<blockquote>
<p>Node.js = Runtime Environment + JavaScript Library</p>
</blockquote>
<p><a href="http://www.ibm.com/developerworks/cn/opensource/os-nodejs/" target="_blank" rel="external">Node.js 究竟是什么？</a> <a href="http://blog.jobbole.com/53736/" target="_blank" rel="external">为什么要用 Node.js ?</a><br><a href="http://www.zhihu.com/question/19653241" target="_blank" rel="external">使用 Node.js 的优势和劣势都有哪些？</a> <a href="https://github.com/nodejs/node-v0.x-archive/wiki/Projects,-Applications,-and-Companies-Using-Node" target="_blank" rel="external">谁在使用 Node.js ?</a>  </p>
<h3 id="安装_Node-js">安装 Node.js</h3><p>可以到 <a href="https://nodejs.org/" target="_blank" rel="external">Node.js 官网</a> 上下载最新的 node-v5.0.0.pkg for OS X (x64) 安装包到本地进行安装。<br>也可以使用 brew（The missing package manager for OS X）包管理器命令行工具进行安装。  </p>
<h4 id="Homebrew">Homebrew</h4><p>brew 全称为 <a href="http://brew.sh/index.html" target="_blank" rel="external">Homebrew</a>，是 UNIX 上的软件包管理工具。  </p>
<blockquote>
<p>Homebrew  is  the easiest and most flexible way to install the UNIX tools.</p>
</blockquote>
<p>在终端使用 <code>brew -v</code> 或 <code>brew --version</code> 命令来查看 Mac 上安装的 Homebrew 版本：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  ~  brew -v  &#10;Homebrew 0.9.5 (git revision 9cbe8; last commit 2015-11-08)</span><br></pre></td></tr></table></figure>
<p>如果没有安装 brew，可在 <a href="http://blog.csdn.net/delphiwcdj/article/details/19679891" target="_blank" rel="external">Mac 上安装 Homebrew</a> <a href="http://blog.csdn.net/aaawqqq/article/details/44088141" target="_blank" rel="external">使 OS X 更完整</a>。</p>
<h4 id="brew_install_node">brew install node</h4><p>执行 <code>brew install node</code> 命令使用 brew 安装 node，提示不能创建 <code>/usr/local/Cellar</code> 目录，原因是没有 <code>/usr/local</code> 的写权限。</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  ~  brew install node&#10;Error: Could not create /usr/local/Cellar&#10;Check you have permission to write to /usr/local</span><br></pre></td></tr></table></figure>
<p><strong><a href="http://segmentfault.com/q/1010000000505091" target="_blank" rel="external">解决方法</a>：</strong></p>
<blockquote>
<p>执行 <code>chown</code> 命令改变 <code>/usr/local</code> 的所有者为 <code>whoami</code> ，<code>-R</code> 表示递归（Recursive）。</p>
</blockquote>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  ~  whoami&#10;faner&#10;&#10;&#10140;  ~  sudo chown -R faner /usr/local&#10;&#10140;  ~  brew install node&#10;==&#62; Downloading https://homebrew.bintray.com/bottles/node-4.2.1.el_capitan.bottle.tar.gz&#10;######################################################################## 100.0%&#10;==&#62; Pouring node-4.2.1.el_capitan.bottle.tar.gz&#10;==&#62; Caveats&#10;Bash completion has been installed to:&#10;  /usr/local/etc/bash_completion.d&#10;==&#62; Summary&#10;&#127866;  /usr/local/Cellar/node/4.2.1: 2738 files, 36M</span><br></pre></td></tr></table></figure>
<p>node installed completion 之后，执行 <code>node -v</code> 命令可查看安装的 node.js 版本：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  ~  node -v&#10;v4.2.1</span><br></pre></td></tr></table></figure>
<h4 id="npm">npm</h4><p>Node.js 默认内置了模块管理工具 —— NPM（Node Package Manager），其灵感来源于 <a href="http://www.cnblogs.com/ihojin/p/ruby-gem-update-the-latest-version.html" target="_blank" rel="external">RubyGems</a>（具有版本和依赖管理功能，可以通过在线资料库便捷安装可重用的组件的管理工具）。<br>NPM 生态系统向所有人开放，任何人都可以发布自己的模块，所有的模块都可以在 NPM 资料库中找到。一个完整的公用模块列表可以在 <a href="https:://npmjs.org/" target="_blank" rel="external">NPM 的网站</a> 上找到，也可以通过与 Node.js 一同安装的 NPM 客户端命令行工具访问。<br>可执行 <code>npm -v</code> 命令查看 <code>node.js</code> 集成的 npm 包管理工具的版本：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  ~  npm -v&#10;2.14.7</span><br></pre></td></tr></table></figure>
<p>执行 <code>npm help</code> 命令可查看帮助：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  ~  npm help&#10;&#10;Usage: npm &#60;command&#62;&#10;&#10;where &#60;command&#62; is one of:&#10;&#10;&#10;&#10;npm &#60;cmd&#62; -h     quick help on &#60;cmd&#62;&#10;npm -l           display full usage info&#10;npm faq          commonly asked questions&#10;npm help &#60;term&#62;  search for help on &#60;term&#62;&#10;npm help npm     involved overview&#10;&#10;Specify configs in the ini-formatted file:&#10;    /Users/faner/.npmrc&#10;or on the command line via: npm &#60;command&#62; --key value&#10;Config info can be viewed via: npm help config&#10;&#10;npm@2.14.7 /usr/local/lib/node_modules/npm</span><br></pre></td></tr></table></figure>
<p>执行 <code>npm -l</code> 命令可查看帮助详情。<br>下文将通过 <code>npm install &lt;pkg&gt;</code> 命令来安装快速、简洁且高效的博客框架——<a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>，并基于 GitPages 托管来搭建免费开源博客。</p>
<h2 id="NPM_安装_hexo">NPM 安装 hexo</h2><h3 id="npm_install_hexo">npm install hexo</h3><p>执行 <code>npm install -g hexo</code> 命令安装 hexo：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  ~  npm install -g hexo&#10;&#10;&#62; fsevents@0.3.8 install /usr/local/lib/node_modules/hexo/node_modules/nunjucks/node_modules/chokidar/node_modules/fsevents&#10;&#62; node-gyp rebuild&#10;&#10;&#62; dtrace-provider@0.6.0 install /usr/local/lib/node_modules/hexo/node_modules/bunyan/node_modules/dtrace-provider&#10;&#62; node scripts/install.js&#10;&#10;&#10;&#62; fsevents@1.0.5 install /usr/local/lib/node_modules/hexo/node_modules/hexo-fs/node_modules/chokidar/node_modules/fsevents&#10;&#62; node-pre-gyp install --fallback-to-build&#10;&#10;[fsevents] Success: &#34;/usr/local/lib/node_modules/hexo/node_modules/hexo-fs/node_modules/chokidar/node_modules/fsevents/lib/binding/Release/node-v46-darwin-x64/fse.node&#34; is installed via remote&#10;/usr/local/bin/hexo -&#62; /usr/local/lib/node_modules/hexo/bin/hexo&#10;hexo@3.1.1 /usr/local/lib/node_modules/hexo</span><br></pre></td></tr></table></figure>
<p><strong>说明：</strong></p>
<blockquote>
<p>npm默认为当前项目安装，<code>-g</code> 表示全局安装。</p>
</blockquote>
<h3 id="hexo_version">hexo version</h3><p>可执行 <code>hexo -v</code> 或  <code>hexo -version</code> 命令来检验安装的 hexo 版本：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  ~  hexo -v&#10;hexo-cli: 0.1.8&#10;os: Darwin 15.0.0 darwin x64&#10;http_parser: 2.5.0&#10;node: 4.2.1&#10;v8: 4.5.103.35&#10;uv: 1.7.5&#10;zlib: 1.2.8&#10;ares: 1.10.1-DEV&#10;icu: 56.1&#10;modules: 46&#10;openssl: 1.0.2d</span><br></pre></td></tr></table></figure>
<h3 id="hexo_help">hexo help</h3><p>可执行 <code>hexo --help</code> 查看帮助：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  ~  hexo --help&#10;Usage: hexo &#60;command&#62;&#10;&#10;Commands:&#10;  help     Get help on Hexo.&#10;  init     Create a new Hexo folder.&#10;  version  Display version information.&#10;&#10;Global Options:&#10;  --config  Specify config file instead of using _config.yml&#10;  --cwd     Specify the CWD&#10;  --debug   Display all verbose messages in the terminal&#10;  --safe    Disable all plugins and scripts&#10;  --silent  Hide output on console&#10;&#10;For more help, you can use &#39;hexo help [command]&#39; for the detailed information&#10;or you can check the docs: http://hexo.io/docs/</span><br></pre></td></tr></table></figure>
<p><strong>常用的 hexo 命令：</strong></p>
<ul>
<li>hexo init <code>&lt;blog&gt;</code> ：</li>
<li>hexo n == hexo new</li>
<li>hexo g == hexo generate</li>
<li>hexo d == hexo deploy</li>
<li>hexo s == hexo server</li>
<li>hexo clean</li>
</ul>
<p><strong>hexo 在线帮助文档：</strong></p>
<ul>
<li><a href="http://hexo.io/docs/" target="_blank" rel="external">http://hexo.io/docs/</a></li>
</ul>
<h2 id="hexo_init">hexo init</h2><p>假设我们接下来将在本地工程目录 <code>Projects/git/blog</code> 下构建博客站点（WebSite）。<br>cd 进入 <code>Projects/git/blog</code> 目录，针对该目录执行 <code>hexo init</code> 命令。</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  ~  cd Projects/git&#10;&#10140;  git  mkdir blog&#10;&#10140;  git  cd blog&#10;&#10140;  blog  hexo init&#10;INFO  Copying data to ~/Projects/git/blog&#10;INFO  You are almost done! Don&#39;t forget to run &#39;npm install&#39; before you start blogging with Hexo!</span><br></pre></td></tr></table></figure>
<h3 id="博客模板">博客模板</h3><p><code>hexo init</code> 初始化成功后，可调用 <code>ls</code> 或 <a href="http://www.aikaiyuan.com/5413.html" target="_blank" rel="external"><code>tree</code></a> 命令查看 hexo 在 blog 目录下生成的模板文件：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  blog  ls&#10;_config.yml  package.json scaffolds    source       themes&#10;&#10140;  blog  tree -L 2&#10;.&#10;&#9500;&#9472;&#9472; _config.yml&#10;&#9500;&#9472;&#9472; package.json&#10;&#9500;&#9472;&#9472; scaffolds&#10;&#9474;&#160;&#160; &#9500;&#9472;&#9472; draft.md&#10;&#9474;&#160;&#160; &#9500;&#9472;&#9472; page.md&#10;&#9474;&#160;&#160; &#9492;&#9472;&#9472; post.md&#10;&#9500;&#9472;&#9472; source&#10;&#9474;&#160;&#160; &#9492;&#9472;&#9472; _posts&#10;&#9492;&#9472;&#9472; themes&#10;    &#9492;&#9472;&#9472; landscape&#10;&#10;5 directories, 5 files</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>文件/目录</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>_config.yml</td>
<td>网站的配置信息</td>
</tr>
<tr>
<td>package.json</td>
<td>应用程序的信息，包括依赖包(dependencies)</td>
</tr>
<tr>
<td>scaffolds</td>
<td>模板文件夹，Hexo 会根据 scaffold 来新建文件。</td>
</tr>
<tr>
<td>source</td>
<td>资源文件夹，<code>_post</code> 目录存放博客源码（markdown文件）</td>
</tr>
<tr>
<td>themes</td>
<td>主题文件夹，默认主题为landscape</td>
</tr>
</tbody>
</table>
<p><code>source</code> 下除 <code>_posts</code> 文件夹之外，开头命名为 <code>_</code> (下划线)的文件 / 文件夹和隐藏的文件 将会被忽略。<code>/source/_posts</code> 目录下默认有一个欢迎页 —— <code>hello-world.md</code> 文件。<br>在下文使用 <code>hexo generate</code> 生成网站时，Hexo 会编译 Markdown 和 HTML 源文件，根据主题来生成静态页面。静态页面文件将会被存放到 <code>public</code> 文件夹，而其他文件会被拷贝过去视作资源。</p>
<h3 id="npm_install">npm install</h3><p>此时，尝试执行 <code>hexo generate</code> 生成包含 Hello World 首页的博客，将提示需要执行<br><code>npm install hexo --save</code> :</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  blog  hexo generate&#10;ERROR Local hexo not found in ~/Projects/git/blog&#10;ERROR Try running: &#39;npm install hexo --save&#39;</span><br></pre></td></tr></table></figure>
<p>实际上，我们已经执行过 <code>npm install hexo</code> 。根据上一步 <code>hexo init</code> 的提示，在正式 blogging with Hexo 之前，需要执行 <code>npm install</code> 命令安装 <code>package.json</code> 里的依赖包（Dependencies）：</p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">➜  blog  hexo <span class="keyword">generate</span></span><br><span class="line"><span class="keyword">ERROR</span> <span class="keyword">Local</span> hexo not found <span class="keyword">in</span> ~/Projects/git/blog</span><br><span class="line"><span class="keyword">ERROR</span> Try running: 'npm install hexo --<span class="keyword">save</span>'</span><br><span class="line"></span><br><span class="line">➜  blog  npm install</span><br><span class="line"></span><br><span class="line">➜  blog  <span class="keyword">ls</span></span><br><span class="line">_config.yml  node_modules package.json scaffolds    source       themes</span><br></pre></td></tr></table></figure>
<p><code>ls</code> 可以查看到目录下将多出 <code>node_modules</code> 文件夹，其中存放 <code>npm install</code> 安装的依赖包。</p>
<h2 id="hexo_generate">hexo generate</h2><p>上面，我们在执行 <code>hexo init</code> 后，再执行 <code>npm install</code> 安装了 package.json 所依赖的包。此时，执行 <code>hexo generate</code> 命令将编译（只有欢迎页：<code>hello-world.md</code>）生成待发布的博客文件。</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  blog  hexo generate&#10;INFO  Files loaded in 290 ms&#10;INFO  Generated: js/script.js&#10;INFO  Generated: fancybox/jquery.fancybox.pack.js&#10;INFO  Generated: fancybox/jquery.fancybox.js&#10;INFO  Generated: fancybox/jquery.fancybox.css&#10;INFO  Generated: fancybox/helpers/jquery.fancybox-thumbs.js&#10;INFO  Generated: fancybox/helpers/jquery.fancybox-thumbs.css&#10;INFO  Generated: fancybox/helpers/jquery.fancybox-media.js&#10;INFO  Generated: fancybox/helpers/jquery.fancybox-buttons.js&#10;INFO  Generated: fancybox/helpers/jquery.fancybox-buttons.css&#10;INFO  Generated: fancybox/helpers/fancybox_buttons.png&#10;INFO  Generated: fancybox/fancybox_sprite@2x.png&#10;INFO  Generated: fancybox/fancybox_sprite.png&#10;INFO  Generated: fancybox/fancybox_overlay.png&#10;INFO  Generated: fancybox/fancybox_loading@2x.gif&#10;INFO  Generated: fancybox/fancybox_loading.gif&#10;INFO  Generated: fancybox/blank.gif&#10;INFO  Generated: css/style.css&#10;INFO  Generated: css/images/banner.jpg&#10;INFO  Generated: css/fonts/fontawesome-webfont.woff&#10;INFO  Generated: css/fonts/fontawesome-webfont.ttf&#10;INFO  Generated: css/fonts/fontawesome-webfont.svg&#10;INFO  Generated: css/fonts/fontawesome-webfont.eot&#10;INFO  Generated: css/fonts/FontAwesome.otf&#10;INFO  Generated: 2015/11/08/hello-world/index.html&#10;INFO  Generated: archives/index.html&#10;INFO  Generated: archives/2015/index.html&#10;INFO  Generated: archives/2015/11/index.html&#10;INFO  Generated: index.html&#10;INFO  28 files generated in 794 ms&#10;&#10140;  blog  ls&#10;_config.yml  node_modules public       source&#10;db.json      package.json scaffolds    themes</span><br></pre></td></tr></table></figure>
<p><code>ls</code> 查看目录下将生成 <code>public</code> 和 <code>db.json</code> 这两个文件夹。</p>
<ol>
<li><code>db.json</code> —— json格式的静态常量数据库。  </li>
<li><code>public</code> 文件夹存放编译后的静态网站（html+css+js），也就是最后要发布的博客。  </li>
</ol>
<h3 id="public">public</h3><p>在 public 目录下执行 <code>tree -L 2</code>，可以查看其目录结构：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  blog  cd public &#10;&#10140;  public  tree -L 2&#10;.&#10;&#9500;&#9472;&#9472; 2015&#10;&#9474;&#160;&#160; &#9492;&#9472;&#9472; 11&#10;&#9500;&#9472;&#9472; archives&#10;&#9474;&#160;&#160; &#9500;&#9472;&#9472; 2015&#10;&#9474;&#160;&#160; &#9492;&#9472;&#9472; index.html&#10;&#9500;&#9472;&#9472; css&#10;&#9474;&#160;&#160; &#9500;&#9472;&#9472; fonts&#10;&#9474;&#160;&#160; &#9500;&#9472;&#9472; images&#10;&#9474;&#160;&#160; &#9492;&#9472;&#9472; style.css&#10;&#9500;&#9472;&#9472; fancybox&#10;&#9474;&#160;&#160; &#9500;&#9472;&#9472; blank.gif&#10;&#9474;&#160;&#160; &#9500;&#9472;&#9472; fancybox_loading.gif&#10;&#9474;&#160;&#160; &#9500;&#9472;&#9472; fancybox_loading@2x.gif&#10;&#9474;&#160;&#160; &#9500;&#9472;&#9472; fancybox_overlay.png&#10;&#9474;&#160;&#160; &#9500;&#9472;&#9472; fancybox_sprite.png&#10;&#9474;&#160;&#160; &#9500;&#9472;&#9472; fancybox_sprite@2x.png&#10;&#9474;&#160;&#160; &#9500;&#9472;&#9472; helpers&#10;&#9474;&#160;&#160; &#9500;&#9472;&#9472; jquery.fancybox.css&#10;&#9474;&#160;&#160; &#9500;&#9472;&#9472; jquery.fancybox.js&#10;&#9474;&#160;&#160; &#9492;&#9472;&#9472; jquery.fancybox.pack.js&#10;&#9500;&#9472;&#9472; index.html&#10;&#9492;&#9472;&#9472; js&#10;    &#9492;&#9472;&#9472; script.js</span><br></pre></td></tr></table></figure>
<ul>
<li><code>index.html</code> 为网站首页。</li>
<li><code>js/</code> ：存放 hexo 的功能 js。</li>
<li><code>css/</code> ：存放 css 样式文件。</li>
<li><code>archives/</code> ：存放博客归档。</li>
<li>[<code>fancybox</code>][] 是一款优秀的 <a href="http://www.cnblogs.com/zhmt/archive/2011/10/06/2200152.html" target="_blank" rel="external">jquery 插件</a>，它能够展示<a href="http://www.helloweba.com/view-blog-65.html" target="_blank" rel="external">丰富的弹出层效果</a>。</li>
</ul>
<h2 id="hexo_server">hexo server</h2><p>上面通过 <code>init</code> 和 <code>generate</code> 之后，已经生成博客网站了。此时，只包含一个默认首页 hello-world.md。  </p>
<p>执行 <code>hexo server</code> 可启动 <strong>hexo server</strong> 进行本地调试：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  blog  hexo server&#10;INFO  Hexo is running at http://0.0.0.0:4000/. Press Ctrl+C to stop.&#10;^CINFO  Bye!&#10;&#10140;  blog</span><br></pre></td></tr></table></figure>
<p>在浏览器中输入 <code>http://localhost:4000</code> 即可访问只含欢迎页和默认主题的 hexo 博客了。<br><img src="http://7xo5uz.com1.z0.glb.clouddn.com/hexo-hello.png" alt="hexo-hello_world"></p>
<p>按下 <code>Ctrl+C</code> 退出 hexo 服务器。</p>
<h2 id="hexo_deploy">hexo deploy</h2><h3 id="配置_Deployment">配置 Deployment</h3><p>修改 <code>_config.yml</code> 文件里面的 Deployment 发布配置。<br>其中 deploy type 修改为 <code>github</code>；repository 修改为自己在 Github 上的 User Pages 的地址：<code>https://github.com/fan2/fan2.github.io.git</code> 。</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"># Deployment&#10;## Docs: http://hexo.io/docs/deployment.html&#10;deploy:&#10;  type: github&#10;  repository: git@github.com:fan2/fan2.github.io.git&#10;  branch: master</span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong></p>
<ol>
<li>Repository：url 必须是 SSH 形式的，不支持 HTTPS 形式，否则会出现错误：<code>is not a valid repositor URL!</code>。  </li>
<li><p>使用 SSH url，如果电脑没有开放 SSH 端口，会致部署失败：</p>
<blockquote>
<p>fatal: Could not read from remote repository.<br>Please make sure you have the correct access rights and the repository exists.</p>
</blockquote>
</li>
<li><p>如果是为一个项目制作介绍网站，那么需要把 branch 设置为 gh-pages 。</p>
</li>
</ol>
<h3 id="hexo_deploy-1">hexo deploy</h3><p>执行 <code>hexo deploy</code> ，将静态网站代码（public/*）上传到 github 上。</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  blog hexo deploy&#10;ERROR Deployer not found: github</span><br></pre></td></tr></table></figure>
<p>原因是在 hexo 3.0 之后, 不仅 github 的 deploy 的 type 从 github 改为了 git，其中的 deploy 功能也被单独做成一个模块，需要另外安装。所以我们需要安装 <strong>hexo-deployer-git</strong>。</p>
<p><strong>解决方案：</strong></p>
<ol>
<li><a href="http://www.v2ex.com/t/175940" target="_blank" rel="external">将 <code>github</code> 修改为 <code>git</code></a>， 还是报错；</li>
<li><a href="http://blog.163.com/gis_warrior/blog/static/19361717320153100184696/" target="_blank" rel="external">安装 <code>hexo-deployer-git</code></a>:</li>
</ol>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  blog npm install hexo-deployer-git --save&#10; &#10;&#62; fsevents@1.0.5 install /Users/faner/Projects/git/blog/node_modules/hexo-deployer-git/node_modules/hexo-fs/node_modules/chokidar/node_modules/fsevents&#10;&#62; node-pre-gyp install --fallback-to-build&#10;&#10;[fsevents] Success: &#34;/Users/faner/Projects/git/blog/node_modules/hexo-deployer-git/node_modules/hexo-fs/node_modules/chokidar/node_modules/fsevents/lib/binding/Release/node-v46-darwin-x64/fse.node&#34; is installed via remote</span><br></pre></td></tr></table></figure>
<p>其中 <code>--save</code> 参数用于把模块的版本号添加到 package.json 文件中的依赖里（dependencies），否则在安装完之后需要手动添加。<br>下载安装完成后，<code>node_modules</code> 下将新增目录 <code>hexo-deployer-git</code>。</p>
<p>此时，重新执行 <code>hexo deploy</code> ，提交发布成功！</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  blog hexo deploy                         &#10;INFO  Deploying: git&#10;INFO  Setting up Git deployment...&#10;Initialized empty Git repository in /Users/faner/Projects/git/blog/.deploy_git/.git/&#10;[master (root-commit) 578b537] First commit&#10; 1 file changed, 0 insertions(+), 0 deletions(-)&#10; create mode 100644 placeholder&#10;INFO  Clearing .deploy folder...&#10;INFO  Copying files from public folder...&#10;&#10;&#10;&#10;To git@github.com:fan2/fan2.github.io.git&#10; + 9a3d901...6fe0445 master -&#62; master (forced update)&#10;Branch master set up to track remote branch master from git@github.com:fan2/fan2.github.io.git.&#10;INFO  Deploy done: git</span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong></p>
<ol>
<li>部署会覆盖掉你之前在版本库 <code>fan2.github.io</code> 中存放的文件。  </li>
<li><code>hexo deploy</code> 时将在博客根目录下生成 <code>.deploy_git</code> 文件夹，下一次 <code>hexo deploy</code> 将会基于 diff 提交差异量。</li>
</ol>
<h2 id="更新博客">更新博客</h2><p>新建博文，其中 postName 是博文题目：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">hexo new &#34;postName&#34;</span><br></pre></td></tr></table></figure>
<p>hexo 会自动在博客目录 <code>source/_posts</code> 下生成 postName.md 文件。</p>
<p>每次修改更新本地博客源码文件后，需要针对该博客目录执行 <code>hexo generate</code> 重新（增量）编译；再键入 <code>hexo deploy</code> 即可上传到 Github 上。这两步也可合并为 <code>hexo d -g</code> ，先生成再部署。<br>如果 SSH 被禁用了，建议手动将 <code>public/</code> 目录下的静态网站 git push 到 GitHub Pages 博客仓库上。</p>
<h2 id="图片存储">图片存储</h2><p>在 <code>source</code> 下建立与博客 <code>blog.md</code> 同名的目录 <code>blog</code> ，用于存放图片等资源文件，首页相对引用成功；但点击进入文章，相对引用失败！<br>可参照 <a href="https://hexo.io/zh-cn/docs/asset-folders.html" target="_blank" rel="external">hexo 资源文件夹</a> ，看看如何设置 asset 相对路径。也可采用<a href="http://www.qiniu.com/" target="_blank" rel="external">七牛</a>等云存储平台做图床，使用绝对路径。</p>
<h2 id="404">404</h2><p>推荐使用<a href="http://www.qq.com/404/" target="_blank" rel="external">腾讯公益404</a>。</p>
<p>新建 source/404.html，在 <code>&lt;body&gt;</code> 部分嵌入腾讯公益404的 js 代码：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">layout: default</span><br><span class="line">---</span><br><span class="line"><span class="tag">&lt;<span class="title">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"UTF-8"</span> /&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="title">title</span>&gt;</span>404<span class="tag">&lt;/<span class="title">title</span>&gt;</span>                                                                                                                                        </span><br><span class="line">    <span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span> <span class="attribute">src</span>=<span class="value">"http://www.qq.com/404/search_children.js"</span> <span class="attribute">charset</span>=<span class="value">"utf-8"</span> <span class="attribute">homePageUrl</span>=<span class="value">"http://col.dog/"</span> <span class="attribute">homePageName</span>=<span class="value">"返回 col.dog 主页"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>修改“homePageUrl”、“homePageName”这两个参数即可定制返回链接。<br>重新生成部署，即可在访问本站不存在的页面（资源）时显示腾讯公益404页面。</p>
<h2 id="配置主题——Next">配置主题——Next</h2><p>在终端 cd 到博客站点目录 <code>Projects/git/blog/theme</code> 下，git clone 下载 NEXT 主题到本地目录 <code>theme/next</code> 下：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#10140;  blog  git clone https://github.com/iissnan/hexo-theme-next theme/next</span><br></pre></td></tr></table></figure>
<p>编辑站点的 <code>_config.yml</code> 文件，将主题从默认的 landscape 切换为 next：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">theme: next # landscape</span><br></pre></td></tr></table></figure>
<p>重新生成部署网站，将按 next 主题风格排版布局站点。</p>
<h3 id="配置菜单">配置菜单</h3><p>编辑 <code>themes/next/_config.yml</code> 里面的 menu 项，配置顶部菜单：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">menu:&#10;  home: /&#10;  archives: /archives&#10;  categories: /categories&#10;  tags: /tags&#10;  # commonweal: /404.html&#10;  about: /about</span><br></pre></td></tr></table></figure>
<ol>
<li>home: /，首页为根目录，点击将显示 index.html 。</li>
<li>archives: /archives，归档，点击将显示文章列表。</li>
<li>categories: /categories，分类，点击将显示文章分类。</li>
<li>tags: /tags，标签，点击将显示文章标签。</li>
<li>about: /about，关于，介绍一下自己。</li>
</ol>
<h3 id="创建分类页面"><a href="https://github.com/iissnan/hexo-theme-next/wiki/%E5%88%9B%E5%BB%BA%E6%A0%87%E7%AD%BE%E4%BA%91%E9%A1%B5%E9%9D%A2" target="_blank" rel="external">创建分类页面</a></h3><p>默认访问 Tags/Categories，会显示 404，找不到页面。</p>
<h3 id="创建标签页面"><a href="https://github.com/iissnan/hexo-theme-next/wiki/%E5%88%9B%E5%BB%BA%E5%88%86%E7%B1%BB%E9%A1%B5%E9%9D%A2" target="_blank" rel="external">创建标签页面</a></h3><p>默认访问 Tags/Categories，会显示 404，找不到页面。</p>
<h3 id="创建“关于我”页面"><a href="https://github.com/iissnan/hexo-theme-next/wiki/%E5%88%9B%E5%BB%BA-%22%E5%85%B3%E4%BA%8E%E6%88%91%22-%E9%A1%B5%E9%9D%A2" target="_blank" rel="external">创建“关于我”页面</a></h3><p>Hexo默认不生成 About 页面，有需要的话可以创建一个叫 about 的 page，然后再添加到菜单项。</p>
<p>在命令行里面输入：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">hexo new page &#34;about&#34;</span><br></pre></td></tr></table></figure>
<p>然后，你会发现 source 里面多了个 about 目录，里面有个 index.md。其实你也可以手动建立，页面的格式和文章一样。</p>
<h2 id="添加多说评论"><a href="https://github.com/iissnan/hexo-theme-next/wiki/%E8%AE%BE%E7%BD%AE%E5%A4%9A%E8%AF%B4-DISQUS" target="_blank" rel="external">添加多说评论</a></h2><p>使用社交账号登录 多说 网站，创建一个站点。具体步骤如下：</p>
<ol>
<li>登录后在首页选择 “我要安装”。</li>
<li>创建站点，填写站点相关信息。注意，<strong>多说域名</strong> 这一栏填写的即是你的 duoshuo_shortname。</li>
<li>编辑主题的 _config.yml 配置文件，注意，不是站点的_config.yml文件 ，添加 duoshuo_shortname 字段，设置如下：</li>
</ol>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">duoshuo_shortname: your-duoshuo-shortname</span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong></p>
<blockquote>
<p>duoshuo short name: 你的多说二级域名为去掉 <code>.duoshuo.com</code> 的前缀部分。</p>
</blockquote>
<h2 id="添加统计">添加统计</h2><h3 id="hexo/next_添加_Google/百度_统计"><a href="https://github.com/iissnan/hexo-theme-next/wiki/%E6%B7%BB%E5%8A%A0-Google---%E7%99%BE%E5%BA%A6-%E7%BB%9F%E8%AE%A1" target="_blank" rel="external">hexo/next 添加 Google/百度 统计</a></h3><p>添加 Google 或者 百度 的统计 ID 即可开启网站统计。</p>
<p>编辑 Next 主题的 _config.yml ，新增字段 google_analytics 或者 baidu_analytics（取决于使用的统计系统）</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">google_analytics: your-analytics-id&#10;baidu_analytics: your-analytics-id</span><br></pre></td></tr></table></figure>
<h4 id="Google_Search_Console">Google Search Console</h4><p>在 <a href="https://www.google.com/webmasters/tools/home?hl=zh-CN" target="_blank" rel="external">Google Search Console</a> 上注册自己的站点，验证身份后可以提交站点地图文件（sitemap.xml），有助于 Google 更好地决定如何抓取您的网站，进而提高博客站点在搜索结果中的曝光率。</p>
<h3 id="hexo/next_添加_腾讯分析">hexo/next 添加 腾讯分析</h3><h4 id="为自己的站点申请腾讯分析_ID">为自己的站点申请腾讯分析 ID</h4><p>1.进入 <a href="http://v2.ta.qq.com/analysis/index" target="_blank" rel="external">腾讯分析首页</a>，使用 QQ 账号登陆。<br>2.登录后，进入 <a href="http://v2.ta.qq.com/bind/site" target="_blank" rel="external">腾讯分析欢迎页</a> ，提示“您还没有注册站点，请先添加您的站点”，需要在编辑框中输入域名或二级域名，这里添加 <code>col.dog</code>。<br>3.请将下列代码添加至网站代码 <code>&lt;/body&gt;</code> 前。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span> <span class="attribute">src</span>=<span class="value">"http://tajs.qq.com/stats?sId=$your_ta_sid"</span> <span class="attribute">charset</span>=<span class="value">"UTF-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>其中 <code>$your_ta_sid</code> 为腾讯分析为你注册的网站分配的 ID。</p>
<p><strong>注意：</strong></p>
<blockquote>
<p>框架式网站请在框架集页面和子框架页面均安装统计代码，框架集页面请安装在 <code>&lt;/head&gt;</code> 前。</p>
</blockquote>
<h4 id="将自己的站点接入腾讯分析">将自己的站点接入腾讯分析</h4><p>1.在目录 <code>/themes/next/layout/_scripts/analytics/</code> 下新建 <code>tencent-analytics.swig</code> 文件，内容如下：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#123;% if theme.tencent_analytics %&#125;&#10;  &#60;script type=&#34;text/javascript&#34;&#62;&#10;    var _hmt = _hmt || [];&#10;    (function() &#123;&#10;      var hm = document.createElement(&#34;script&#34;);&#10;      hm.src = &#34;//tajs.qq.com/stats?sId=&#123;&#123; theme.tencent_analytics &#125;&#125;&#34;;&#10;      var s = document.getElementsByTagName(&#34;script&#34;)[0];&#10;      s.parentNode.insertBefore(hm, s);&#10;    &#125;)();&#10;  &#60;/script&#62;&#10;&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>
<p>以上代码的意思是，如果 theme 配置了 <code>tencent_analytics</code> ID，则添加腾讯分析的 <code>&lt;script&gt;</code> 代码。</p>
<p>2.打开 <code>/themes/next/layout/_scripts/analytics.swig</code> 文件，在末尾添加包含 <code>tencent-analytics.swig</code> 文件：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#123;% include &#39;analytics/tencent-analytics.swig&#39; %&#125;</span><br></pre></td></tr></table></figure>
<p>3.打开 <code>/themes/next/_config.yml</code> 文件，在其中增加配置字段 <code>tencent_analytics</code>，其值为 <code>your_ta_sid</code>。</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">tencent_analytics: $your_ta_sid</span><br></pre></td></tr></table></figure>
<p>4.重新生成部署网站，则可接入腾讯分析。<br>在 腾讯分析 网站的个人站点列表中可以浏览网站概况，其中列出了 今日浏览量（PV）、今日独立IP、今日用户量（UV） 等统计分析指标。</p>
<h2 id="<!-以下是本文的脚注和超链接->"><!--以下是本文的脚注和超链接--></h2>]]></content>
    <summary type="html">
    <![CDATA[<p>本文详细记录了从安装 node.js / Hexo 到 使用 hexo 发布 markdown 格式的博客并托管到 GitHub 的全过程。</p>]]>
    
    </summary>
    
      <category term="博客志" scheme="http://col.dog/tags/%E5%8D%9A%E5%AE%A2%E5%BF%97/"/>
    
      <category term="Hexo" scheme="http://col.dog/categories/Hexo/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[坳口]]></title>
    <link href="http://col.dog/2015/11/08/col/"/>
    <id>http://col.dog/2015/11/08/col/</id>
    <published>2015-11-08T12:04:46.000Z</published>
    <updated>2015-11-13T00:10:12.000Z</updated>
    <content type="html"><![CDATA[<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">col 英[kɒ<span class="keyword">l</span>] 美[kɑ:<span class="keyword">l</span>]</span><br><span class="line"><span class="keyword">n</span>.	坳; 山口; 关口，峡路，关隘; 山坞;</span><br></pre></td></tr></table></figure>
<p><img src="http://7xo5uz.com1.z0.glb.clouddn.com/coltree.jpg" alt="一棵被遗弃在坳口上的树"></p>
<a id="more"></a>
<p>记忆中的坳口<br>风总是很大<br>翻过坳口<br>就是我们的家</p>
<p>站在坳口<br>能眺望远方的世界<br>能望见田野的油菜花<br>那袅袅升起的炊烟<br>不知是哪家厨房里<br>正在忙碌的妈妈</p>
<p>翻山越岭到坳口<br>熄灭咆哮一路的汽车火花<br>欢快的车轱辘一路空档向下<br>满载一路的团圆梦<br>驶向温暖的家</p>
<p>汽车开出了坳口<br>我们便在路上向别处奋发<br>回去吧爸爸妈妈<br>寒来暑往中<br>我们渐渐长大</p>
<p>而如今<br>在那迎来送往的坳口<br>葬着我的爸爸<br>只有那棵二叉香樟树<br>和那春风吹又生的野草<br>日夜陪伴着他</p>
<hr>

<p>– 2012.12</p>
]]></content>
    <summary type="html">
    <![CDATA[<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">col 英[kɒ<span class="keyword">l</span>] 美[kɑ:<span class="keyword">l</span>]</span><br><span class="line"><span class="keyword">n</span>.	坳; 山口; 关口，峡路，关隘; 山坞;</span><br></pre></td></tr></table></figure>
<p><img src="http://7xo5uz.com1.z0.glb.clouddn.com/coltree.jpg" alt="一棵被遗弃在坳口上的树"></p>]]>
    
    </summary>
    
      <category term="坳口" scheme="http://col.dog/tags/%E5%9D%B3%E5%8F%A3/"/>
    
      <category term="故乡" scheme="http://col.dog/categories/%E6%95%85%E4%B9%A1/"/>
    
  </entry>
  
</feed>
